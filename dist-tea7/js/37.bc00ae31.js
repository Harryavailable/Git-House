"use strict";(self["webpackChunkvue_tea"]=self["webpackChunkvue_tea"]||[]).push([[37],{8037:function(s,t,e){e.r(t),e.d(t,{default:function(){return v}});var a=function(){var s=this,t=s._self._c;return t("div",{staticClass:"cart container"},[t("header",[t("i",{staticClass:"iconfont icon-fanhui",on:{click:s.backNextPage}}),t("span",[s._v("购物车")]),t("i",{staticClass:"iconfont icon-bianji",on:{click:s.isNavaBar}})]),t("section",[t("div",{directives:[{name:"show",rawName:"v-show",value:s.hasShop,expression:"hasShop"}]},[t("div",{staticClass:"sp"},[t("van-checkbox",{attrs:{"checked-color":"#ee0a24"},on:{click:s.checkAllFn},model:{value:s.checked,callback:function(t){s.checked=t},expression:"checked"}}),t("span",[s._v("商品")])],1),s._l(s.shopList,(function(e,a){return t("div",{key:a,staticClass:"shopList",staticStyle:{"margin-top":"0.3rem"}},[t("div",{staticClass:"shopList-left"},[t("van-checkbox",{attrs:{value:1==e.goods_check,"checked-color":"#ee0a24"},on:{click:function(t){return s.changeOneList(e.id,a)}}})],1),t("div",{staticClass:"shopList-center"},[t("img",{attrs:{src:e.goods_imgUrl,alt:""}})]),t("div",{staticClass:"shopList-right"},[t("span",{staticClass:"span"},[t("b",[s._v(s._s(e.goods_recommed))]),t("i",{staticClass:"iconfont icon-changyonggoupiaorenshanchu",on:{click:function(t){return s.deleteThisShop(e.id,a)}}})]),t("span",{staticClass:"span"},[t("b",[t("span",[s._v("名称:")]),s._v(" "+s._s(e.goods_name))])]),t("span",{staticClass:"span"},[t("b",{staticStyle:{color:"red"}},[t("span",[s._v("￥")]),s._v(s._s(e.goods_price))])]),t("span",{staticClass:"span"},[t("b",[t("span",[s._v("数量:")]),s._v(" "+s._s(e.goods_num))]),t("van-stepper",{attrs:{"disable-input":!0},on:{change:function(t){return s.changeNumber(e.id,e.goods_num)}},model:{value:e.goods_num,callback:function(t){s.$set(e,"goods_num",t)},expression:"item.goods_num"}})],1)])])}))],2),t("div",{directives:[{name:"show",rawName:"v-show",value:!s.hasShop,expression:"!hasShop"}],staticClass:"hasShop"},[t("img",{attrs:{src:e(3517),alt:""}}),s._m(0)])]),t("footer",{directives:[{name:"show",rawName:"v-show",value:s.hasShop&&!s.isNavStatus,expression:"hasShop && !isNavStatus"}]},[t("div",{staticClass:"radio"},[t("van-checkbox",{attrs:{"checked-color":"#ee0a24"},on:{click:s.checkAllFn},model:{value:s.checked,callback:function(t){s.checked=t},expression:"checked"}})],1),t("div",{staticClass:"shopTotal"},[t("span",[s._v("共有"),t("b",[s._v(s._s(s.allNumber))]),s._v("件商品")]),t("span",[s._v("总共："),t("b",[s._v("￥"+s._s(s.allMoney)+"+0茶币")])])]),t("div",{staticClass:"toSettle",on:{click:s.gotoOrderPage}},[s._v("去结算")])]),t("div",{directives:[{name:"show",rawName:"v-show",value:s.isNavStatus&&s.hasShop,expression:"isNavStatus && hasShop"}],staticClass:"deleteShop",on:{click:s.allDeleteShop}},[s._v(" 删除 ")])])},i=[function(){var s=this,t=s._self._c;return t("h3",[t("i",{staticClass:"iconfont icon-tixing1"}),s._v(" 您的购物车中暂无商品")])}],o=(e(7658),e(6665)),c=e(7535),h=e(629),n=e(4297),l=e(9146),r={name:"Cart-vue",data(){return{shopList:[],hasShop:!0,checked:!0,selectList:[],isNavStatus:!1,list:[]}},created(){this.getData()},activated(){this.getData()},methods:{...(0,h.OI)(["LIST_DATA"]),async getData(){let s=await(0,o.IU)();200==s.data.code&&(s.data.data.r.length>0?(this.hasShop=!0,this.shopList=s.data.data.r,this.LIST_DATA(s.data.data.r),this.selectList=this.shopList.map((s=>s.id))):this.hasShop=!1)},backNextPage(){this.isNavStatus=!1,this.$router.push("/home")},checkAllFn(){this.selectList.length==this.shopList.length?(this.checked=!1,this.shopList.forEach((s=>{s.goods_check=2})),this.selectList=[]):(this.checked=!0,this.shopList.forEach((s=>{s.goods_check=1,-1==this.selectList.indexOf(s.id)&&this.selectList.push(s.id)})))},changeOneList(s,t){if(1==this.shopList[t].goods_check){let e=this.selectList.indexOf(s);this.selectList.splice(e,1),this.shopList[t].goods_check++,this.checked=!1}else this.shopList[t].goods_check--,this.selectList.push(s),this.selectList.length==this.shopList.length&&(this.checked=!0)},isNavaBar(){this.hasShop&&(this.isNavStatus=!this.isNavStatus)},deleteThisShop(s){n.Z.confirm({title:"删除",message:"您确定要删除吗？"}).then((async()=>{let t=await(0,o.CI)(s);200==t.data.code&&(this.getData(),(0,l.Z)("删除成功！"))}))},async allDeleteShop(){0==this.selectList.length?(0,l.Z)("请选择商品"):n.Z.confirm({title:"删除",message:"您确定要删除吗？"}).then((async()=>{let s=await(0,o.$x)(this.selectList);200==s.data.code&&(this.getData(),this.selectList=[])}))},async changeNumber(s,t){let e=await(0,o.N)(s,t);200==e.data.code&&console.log("修改成功")},async gotoOrderPage(){if(this.selectList.length>0){for(let t of this.shopList)-1!=this.selectList.indexOf(t.id)&&this.list.push(t);let s=await(0,c.fS)(this.list);200==s.data.code&&(this.$store.state.cart.productToken=s.data.data.producT,this.$router.push({name:"Order",params:{num:this.allNumber,price:this.allMoney,selectList:this.selectList}}))}else(0,l.Z)("您还未选择商品")}},computed:{allMoney(){let s=0;return this.shopList.forEach((t=>{1==t.goods_check&&(s+=t.goods_price*t.goods_num)})),s.toFixed(2)},allNumber(){let s=0;return this.shopList.forEach((t=>{1==t.goods_check&&(s=1*s+1*t.goods_num)})),s}}},d=r,p=e(1001),u=(0,p.Z)(d,a,i,!1,null,"194d8d1e",null),v=u.exports},6665:function(s,t,e){e.d(t,{$x:function(){return h},CI:function(){return c},IU:function(){return o},N:function(){return n},xL:function(){return i}});var a=e(8859);const i=s=>(0,a.Z)({url:"/api/shop/addCart",method:"post",data:{goodsId:s}}),o=()=>(0,a.Z)({url:"/api/shop/getShopList",method:"get"}),c=s=>(0,a.Z)({url:"/api/shop/deleteCart",method:"post",data:{id:s}}),h=s=>(0,a.Z)({url:"/api/shop/deleteAllCart",method:"post",data:{idArr:s}}),n=(s,t)=>(0,a.Z)({url:"/api/shop/updateShopNum",method:"post",data:{id:s,num:t}})},3517:function(s,t,e){s.exports=e.p+"img/暂无数据.c4e4a41c.png"}}]);
//# sourceMappingURL=37.bc00ae31.js.map